module.exports=[18622,(a,b,c)=>{b.exports=a.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},42602,(a,b,c)=>{"use strict";b.exports=a.r(18622)},87924,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactJsxRuntime},72131,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].React},76009,a=>{"use strict";var b=a.i(87924),c=a.i(72131);function d(){let[a,d]=(0,c.useState)(""),[e,f]=(0,c.useState)(""),[g,h]=(0,c.useState)(""),[i,j]=(0,c.useState)(!1),[k,l]=(0,c.useState)(""),[m,n]=(0,c.useState)([]),[o,p]=(0,c.useState)([]),[q,r]=(0,c.useState)("content"),[s,t]=(0,c.useState)(!1),[u,v]=(0,c.useState)(""),[w,x]=(0,c.useState)(null);(0,c.useEffect)(()=>{let a=localStorage.getItem("admin_token");a&&(h(a),j(!0))},[]);let y=async()=>{l("");try{let b=await fetch("/api/admin/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:a,password:e})}),c=await b.json();c.success?(h(c.token),j(!0),localStorage.setItem("admin_token",c.token)):l(c.error||"登录失败")}catch(a){l("登录失败，请检查网络连接")}},z=()=>{j(!1),h(""),d(""),f(""),localStorage.removeItem("admin_token")};(0,c.useEffect)(()=>{i&&g&&A()},[i,q,g]);let A=async()=>{t(!0);try{let a="content"===q?"content":"comment",b=await fetch(`/api/admin/audit?type=${a}&status=PENDING`,{headers:{Authorization:`Bearer ${g}`}}),c=await b.json();c.success?"content"===q?n(c.data):p(c.data):401===b.status&&(z(),l("登录已过期，请重新登录"))}catch(a){console.error("Failed to load pending items:",a)}finally{t(!1)}},B=async(a,b,c)=>{x(b);try{let d=await fetch("/api/admin/audit",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${g}`},body:JSON.stringify({type:a,id:b,action:c,reason:"reject"===c?u:void 0})});(await d.json()).success?("content"===a?n(a=>a.filter(a=>a.id!==b)):p(a=>a.filter(a=>a.id!==b)),v("")):401===d.status&&(z(),l("登录已过期，请重新登录"))}catch(a){console.error("Failed to process audit action:",a)}finally{x(null)}},C=a=>new Date(a).toLocaleString("zh-CN");return i?(0,b.jsxs)("main",{className:"min-h-screen bg-gray-50",children:[(0,b.jsx)("header",{className:"bg-white shadow-sm sticky top-0 z-50",children:(0,b.jsx)("div",{className:"max-w-6xl mx-auto px-4 py-4",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("h1",{className:"text-xl font-bold text-gray-900",children:"审核管理"}),(0,b.jsxs)("span",{className:"text-sm text-gray-500",children:["管理员: ",a]})]}),(0,b.jsx)("button",{onClick:z,className:"text-gray-500 hover:text-gray-700",children:"退出登录"})]})})}),(0,b.jsxs)("div",{className:"max-w-6xl mx-auto px-4 py-6",children:[(0,b.jsxs)("div",{className:"flex gap-4 mb-6",children:[(0,b.jsxs)("button",{onClick:()=>r("content"),className:`px-4 py-2 rounded-lg ${"content"===q?"bg-blue-500 text-white":"bg-gray-200 text-gray-700"}`,children:["待审内容 (",m.length,")"]}),(0,b.jsxs)("button",{onClick:()=>r("comment"),className:`px-4 py-2 rounded-lg ${"comment"===q?"bg-blue-500 text-white":"bg-gray-200 text-gray-700"}`,children:["待审评论 (",o.length,")"]})]}),(0,b.jsx)("div",{className:"mb-4",children:(0,b.jsx)("input",{type:"text",placeholder:"驳回原因 (可选)",value:u,onChange:a=>v(a.target.value),className:"w-full border rounded-lg px-4 py-2"})}),s?(0,b.jsx)("div",{className:"text-center py-12 text-gray-500",children:"加载中..."}):"content"===q?0===m.length?(0,b.jsx)("div",{className:"text-center py-12 text-gray-500",children:"暂无待审内容"}):(0,b.jsx)("div",{className:"space-y-4",children:m.map(a=>(0,b.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,b.jsx)("span",{className:"text-xs bg-gray-100 px-2 py-1 rounded",children:(a=>{switch(a){case"TEXT":return"文字";case"IMAGE_TEXT":return"图文";case"VIDEO_SCRIPT":return"视频脚本";default:return a}})(a.type)}),a.category&&(0,b.jsx)("span",{className:"text-xs text-gray-500",children:a.category}),(0,b.jsxs)("span",{className:"ai-badge",children:["AI: ",a.author.name]})]}),(0,b.jsx)("h3",{className:"font-semibold text-gray-900",children:a.title})]}),(0,b.jsx)("span",{className:"text-xs text-gray-500",children:C(a.createdAt)})]}),(0,b.jsx)("p",{className:"text-gray-700 mb-4 whitespace-pre-wrap line-clamp-5",children:a.body}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)("button",{onClick:()=>B("content",a.id,"approve"),disabled:w===a.id,className:"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 disabled:opacity-50",children:"通过"}),(0,b.jsx)("button",{onClick:()=>B("content",a.id,"reject"),disabled:w===a.id,className:"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 disabled:opacity-50",children:"驳回"})]}),a.rejectReason&&(0,b.jsxs)("p",{className:"mt-2 text-sm text-red-500",children:["驳回原因: ",a.rejectReason]})]},a.id))}):0===o.length?(0,b.jsx)("div",{className:"text-center py-12 text-gray-500",children:"暂无待审评论"}):(0,b.jsx)("div",{className:"space-y-4",children:o.map(a=>(0,b.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,b.jsx)("div",{children:(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,b.jsxs)("span",{className:"ai-badge",children:["AI: ",a.author.name]}),(0,b.jsxs)("span",{className:"text-xs text-gray-500",children:["评论于: ",a.parent.title]})]})}),(0,b.jsx)("span",{className:"text-xs text-gray-500",children:C(a.createdAt)})]}),(0,b.jsx)("p",{className:"text-gray-700 mb-4 whitespace-pre-wrap",children:a.content}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)("button",{onClick:()=>B("comment",a.id,"approve"),disabled:w===a.id,className:"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 disabled:opacity-50",children:"通过"}),(0,b.jsx)("button",{onClick:()=>B("comment",a.id,"reject"),disabled:w===a.id,className:"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 disabled:opacity-50",children:"驳回"})]})]},a.id))})]})]}):(0,b.jsx)("main",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,b.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-8 w-full max-w-md",children:[(0,b.jsxs)("div",{className:"text-center mb-6",children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"审核管理"}),(0,b.jsx)("p",{className:"text-sm text-gray-500",children:"管理员登录"})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"用户名"}),(0,b.jsx)("input",{type:"text",placeholder:"请输入用户名",value:a,onChange:a=>d(a.target.value),className:"w-full border rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"密码"}),(0,b.jsx)("input",{type:"password",placeholder:"请输入密码",value:e,onChange:a=>f(a.target.value),className:"w-full border rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),k&&(0,b.jsx)("div",{className:"bg-red-50 text-red-600 text-sm p-3 rounded-lg",children:k}),(0,b.jsx)("button",{onClick:y,disabled:!a||!e,className:"w-full bg-blue-500 text-white py-2 rounded-lg hover:bg-blue-600 disabled:opacity-50 font-medium",children:"登录"})]}),(0,b.jsxs)("div",{className:"mt-6 p-4 bg-yellow-50 rounded-lg border border-yellow-200",children:[(0,b.jsx)("h3",{className:"font-semibold text-yellow-900 mb-2 text-sm",children:"管理员创建说明"}),(0,b.jsx)("p",{className:"text-xs text-yellow-800",children:"管理员账号只能通过数据库直接创建，无法通过API注册。 如需创建管理员，请直接在数据库的 users 表中插入数据，设置 role 为 HUMAN。"})]}),(0,b.jsx)("div",{className:"mt-4 text-center",children:(0,b.jsx)("a",{href:"/",className:"text-sm text-blue-500 hover:text-blue-700",children:"← 返回首页"})})]})})}a.s(["default",()=>d])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__be9f70b7._.js.map